========================================
 Cuaderno 1: Fundamentos de Docker
========================================

Objetivo:
Aprender los conceptos clave de Docker, desde la instalaci√≥n hasta la creaci√≥n de contenedores y su gesti√≥n en la nube (AWS).

----------------------------------------------------------------------
EJERCICIO 1: Instalaci√≥n de Docker
----------------------------------------------------------------------
1) Con√©ctate a tu instancia EC2 por SSH:
   ssh -i /ruta/tu-llave.pem ec2-user@<IP-de-tu-instancia>

2) Actualiza los paquetes del sistema:
   sudo yum update -y

3) Instala Docker:
   sudo yum install docker -y

4) Inicia el servicio de Docker:
   sudo systemctl start docker

5) Habilita Docker para que se inicie al reiniciar:
   sudo systemctl enable docker

6) Verifica la versi√≥n instalada:
   docker --version

----------------------------------------------------------------------
EJERCICIO 2: Ejecutar tu primer contenedor
----------------------------------------------------------------------
1) Ejecuta el contenedor de prueba:
   docker run hello-world

2) Observa la salida y describe el mensaje del contenedor.

----------------------------------------------------------------------
EJERCICIO 3: Descargar y ejecutar una imagen de Nginx
----------------------------------------------------------------------
1) Descarga la imagen de Nginx:
   docker pull nginx

2) Ejecuta un contenedor con Nginx en el puerto 8080:
   docker run -d -p 8080:80 nginx

3) Comprueba que se est√° ejecutando:
   docker ps

4) Abre el navegador en http://<tu-IP-EC2>:8080 para verificar Nginx.

----------------------------------------------------------------------
EJERCICIO 4: Inspeccionar un contenedor en ejecuci√≥n
----------------------------------------------------------------------
1) Lista los contenedores en ejecuci√≥n:
   docker ps

2) Obt√©n informaci√≥n detallada:
   docker inspect <container_id>

----------------------------------------------------------------------
EJERCICIO 5: Crear un contenedor interactivo con Ubuntu
----------------------------------------------------------------------
1) Ejecuta Ubuntu en modo interactivo:
   docker run -it ubuntu bash

2) Prueba algunos comandos (ls -l, uname -a).

3) Sal del contenedor con:
   exit

----------------------------------------------------------------------
EJERCICIO 6: Construir una imagen personalizada
----------------------------------------------------------------------
1) Crea un directorio y entra en √©l:
   mkdir docker-test
   cd docker-test

2) Crea un archivo Dockerfile con este contenido:

   FROM ubuntu
   RUN apt update && apt install -y curl
   CMD ["bash"]

3) Construye la imagen:
   docker build -t mi-imagen .

4) Ejecuta un contenedor con tu imagen:
   docker run -it mi-imagen

----------------------------------------------------------------------
EJERCICIO 7: Configurar variables de entorno en un contenedor
----------------------------------------------------------------------
1) Ejecuta un contenedor con variable de entorno:
   docker run -e "MI_VARIABLE=HolaMundo" ubuntu env

2) Observa la salida para ver "MI_VARIABLE=HolaMundo".

----------------------------------------------------------------------
EJERCICIO 8: Montar vol√∫menes para persistencia de datos
----------------------------------------------------------------------
1) Crea un volumen:
   docker volume create mi-volumen

2) Ejecuta un contenedor con el volumen montado:
   docker run -it -v mi-volumen:/data ubuntu bash

3) Crea un archivo dentro del contenedor (por ejemplo):
   echo "Prueba de persistencia" > /data/archivo.txt

4) Verifica que persiste incluso si paras el contenedor.

----------------------------------------------------------------------
EJERCICIO 9: Crear y administrar redes en Docker
----------------------------------------------------------------------
1) Crea una red personalizada:
   docker network create mi-red

2) Ejecuta un contenedor dentro de esa red:
   docker run -dit --network mi-red --name contenedor1 ubuntu

3) Verifica la conexi√≥n entre contenedores usando ping (puedes crear otro contenedor en la misma red).

----------------------------------------------------------------------
EJERCICIO 10: Ejecutar una base de datos en Docker
----------------------------------------------------------------------
1) Ejecuta un contenedor MySQL:
   docker run --name mysql-db -e MYSQL_ROOT_PASSWORD=1234 -d mysql

2) Con√©ctate a la base de datos dentro del contenedor:
   docker exec -it mysql-db bash
   mysql -u root -p (introduce la contrase√±a "1234")

----------------------------------------------------------------------
CONSEJOS FINALES
----------------------------------------------------------------------
- Detener contenedores:
  docker stop <container_id>

- Eliminar contenedores:
  docker rm <container_id>

- Eliminar im√°genes:
  docker rmi <image_id>

- Limpiar recursos en desuso (con cuidado):
  docker system prune







========================================
 Cuaderno 2: Dockerizaci√≥n de una Aplicaci√≥n Web Completa
========================================

Asignatura: Digitalizaci√≥n

Objetivo:
En este cuaderno aprender√°s a dockerizar una aplicaci√≥n web completa compuesta por:
- Un frontend en HTML, CSS y JavaScript
- Un backend con Node.js y Express
- Una base de datos en AWS PostgreSQL

Realizar√°s cada paso desde la configuraci√≥n inicial hasta la ejecuci√≥n con docker-compose,
conect√°ndote por SSH a una m√°quina EC2 en AWS.

----------------------------------------------------------------------
EJERCICIO 1: Configurar el Entorno en EC2
----------------------------------------------------------------------
Teor√≠a:
Antes de empezar a dockerizar nuestra aplicaci√≥n, necesitamos preparar la
m√°quina en AWS EC2.

Pr√°ctica:
1) Con√©ctate a tu instancia EC2 mediante SSH:
   ssh -i /ruta/tu-llave.pem ec2-user@<IP-de-tu-instancia>

2) Actualiza los paquetes del sistema:
   sudo yum update -y

3) Instala Docker y Git:
   sudo yum install docker git -y

4) Inicia y habilita el servicio de Docker:
   sudo systemctl start docker
   sudo systemctl enable docker

5) Verifica la instalaci√≥n ejecutando:
   docker --version

----------------------------------------------------------------------
EJERCICIO 2: Crear el Proyecto y Configurar Node.js
----------------------------------------------------------------------
Teor√≠a:
El backend ser√° una API en Express.js que se comunicar√° con la base de datos
y el frontend.

Pr√°ctica:
1) Crea o clona un repositorio:
   git clone <tu-repositorio>
   cd <nombre-del-repositorio>
   (o bien mkdir mi-proyecto && cd mi-proyecto)

2) Inicializa un proyecto Node.js:
   npm init -y

3) Instala Express, pg, cors y dotenv:
   npm install express pg cors dotenv

4) Crea un archivo server.js con un servidor b√°sico:
   -------------------------------------------------
   const express = require('express');
   const app = express();
   app.get('/', (req, res) => res.send('API funcionando'));
   app.listen(3000, () => console.log('Servidor en puerto 3000'));
   -------------------------------------------------

5) Ejecuta el servidor:
   node server.js

----------------------------------------------------------------------
EJERCICIO 3: Crear un Dockerfile para el Backend
----------------------------------------------------------------------
Teor√≠a:
El Dockerfile define c√≥mo se construye la imagen del backend.

Pr√°ctica:
1) Crea un archivo Dockerfile en la ra√≠z del backend con el siguiente contenido:
   -------------------------------------------------
   FROM node:18
   WORKDIR /app
   COPY package.json .
   RUN npm install
   COPY . .
   CMD ["node", "server.js"]
   EXPOSE 3000
   -------------------------------------------------

2) Construye la imagen:
   docker build -t mi-backend .

3) Ejecuta el contenedor:
   docker run -p 3000:3000 mi-backend

----------------------------------------------------------------------
EJERCICIO 4: Conectar el Backend con AWS PostgreSQL
----------------------------------------------------------------------
Teor√≠a:
La base de datos debe configurarse en AWS RDS y conectarse con Express.

Pr√°ctica:
1) Crea una base de datos PostgreSQL en AWS RDS y anota la URL de conexi√≥n,
   usuario, contrase√±a y nombre de la base de datos.

2) Modifica server.js para conectarse a PostgreSQL usando pg:
   -------------------------------------------------
   const { Pool } = require('pg');
   const pool = new Pool({
       user: 'admin',
       host: '<URL_RDS>',
       database: 'mi_base',
       password: 'contrase√±a',
       port: 5432
   });
   -------------------------------------------------
   Realiza una consulta de prueba para verificar la conexi√≥n.

----------------------------------------------------------------------
EJERCICIO 5: Crear la Imagen del Frontend
----------------------------------------------------------------------
Teor√≠a:
El frontend es est√°tico y lo serviremos con Nginx.

Pr√°ctica:
1) Crea una carpeta frontend con archivos HTML, CSS y JS.

2) Crea un Dockerfile en la carpeta frontend:
   -------------------------------------------------
   FROM nginx
   COPY . /usr/share/nginx/html
   EXPOSE 80
   -------------------------------------------------

3) Construye y ejecuta el contenedor:
   docker build -t mi-frontend .
   docker run -p 8080:80 mi-frontend

----------------------------------------------------------------------
EJERCICIO 6: Configurar docker-compose
----------------------------------------------------------------------
Teor√≠a:
Docker Compose nos permite definir y ejecutar m√∫ltiples contenedores juntos.

Pr√°ctica:
1) Crea un archivo docker-compose.yml en la ra√≠z del proyecto:
   -------------------------------------------------
   version: '3'
   services:
     backend:
       build: ./backend
       ports:
         - "3000:3000"
     frontend:
       build: ./frontend
       ports:
         - "8080:80"
   -------------------------------------------------

2) Levanta los servicios:
   docker-compose up -d

----------------------------------------------------------------------
EJERCICIO 7: Crear Variables de Entorno
----------------------------------------------------------------------
Teor√≠a:
Las credenciales no deben estar en el c√≥digo.

Pr√°ctica:
1) Crea un archivo .env con:
   -------------------------------------------------
   DB_HOST=<URL_RDS>
   DB_USER=admin
   DB_PASS=contrase√±a
   DB_NAME=mi_base
   -------------------------------------------------

2) Modifica server.js para leerlas con dotenv:
   -------------------------------------------------
   require('dotenv').config();
   const pool = new Pool({
       user: process.env.DB_USER,
       host: process.env.DB_HOST,
       database: process.env.DB_NAME,
       password: process.env.DB_PASS,
       port: 5432
   });
   -------------------------------------------------

----------------------------------------------------------------------
EJERCICIO 8: Subir las Im√°genes a Docker Hub
----------------------------------------------------------------------
Teor√≠a:
Para desplegar en producci√≥n, debemos subir las im√°genes a Docker Hub.

Pr√°ctica:
1) Inicia sesi√≥n en Docker Hub:
   docker login

2) Etiqueta las im√°genes y s√∫belas:
   docker tag mi-backend usuario/mi-backend
   docker push usuario/mi-backend

   docker tag mi-frontend usuario/mi-frontend
   docker push usuario/mi-frontend

----------------------------------------------------------------------
EJERCICIO 9: Desplegar en AWS EC2 con Docker Compose
----------------------------------------------------------------------
Teor√≠a:
AWS EC2 ejecutar√° docker-compose en producci√≥n.

Pr√°ctica:
1) Con√©ctate a EC2 y clona el repositorio.

2) Ejecuta:
   docker-compose up -d

----------------------------------------------------------------------
EJERCICIO 10: Configurar un Proxy Reverso con Nginx
----------------------------------------------------------------------
Teor√≠a:
Nginx puede gestionar el tr√°fico entre el frontend y backend.

Pr√°ctica:
1) Crea un archivo de configuraci√≥n en /etc/nginx/conf.d/default.conf:
   -------------------------------------------------
   server {
       location / {
           proxy_pass http://backend:3000;
       }
   }
   -------------------------------------------------

2) Reinicia Nginx:
   systemctl restart nginx

Con estos ejercicios, tendr√°s una aplicaci√≥n completa dockerizada
lista para desplegarse en producci√≥n.







========================================
 Cuaderno 3: Publicaci√≥n de una Aplicaci√≥n en AWS con Docker y Load Balancer
========================================

Asignatura: Digitalizaci√≥n

Objetivo:
En este cuaderno, aprender√°s a desplegar una aplicaci√≥n web completa en AWS con:
- Frontend en una instancia EC2 con Docker
- Backend en otra instancia EC2 con Docker
- Base de datos PostgreSQL en AWS RDS
- Application Load Balancer (ALB) para distribuir el tr√°fico
- Configuraci√≥n de Security Groups y Listeners para la comunicaci√≥n entre los servicios

Todos los ejercicios se realizar√°n conect√°ndose por SSH a las instancias EC2.

----------------------------------------------------------------------
EJERCICIO 1: Configuraci√≥n de las Instancias EC2
----------------------------------------------------------------------
Teor√≠a:
Las instancias EC2 ser√°n los servidores donde se ejecutar√°n el frontend y
el backend. Es importante configurar correctamente las reglas de seguridad.

Pr√°ctica:
1) Crea dos instancias EC2 en AWS:
   - Instancia para el Frontend
   - Instancia para el Backend

2) Asigna un Security Group a cada instancia con estas reglas:
   - Frontend: Permitir tr√°fico entrante en el puerto 80 desde internet.
   - Backend: Permitir tr√°fico entrante solo desde la IP del frontend en el puerto 3000.

3) Con√©ctate a cada instancia por SSH y actualiza los paquetes:
   -------------------------------------------------
   sudo yum update -y
   -------------------------------------------------

4) Instala Docker en ambas instancias:
   -------------------------------------------------
   sudo yum install docker -y
   sudo systemctl start docker
   sudo systemctl enable docker
   -------------------------------------------------

----------------------------------------------------------------------
EJERCICIO 2: Implementaci√≥n del Backend con Docker
----------------------------------------------------------------------
Teor√≠a:
El backend ser√° una API en Node.js con Express, ejecutada dentro de un
contenedor Docker.

Pr√°ctica:
1) Con√©ctate a la instancia del backend.

2) Clona el repositorio del backend o crea un nuevo proyecto.

3) Crea un Dockerfile para la API:
   -------------------------------------------------
   FROM node:18
   WORKDIR /app
   COPY package.json .
   RUN npm install
   COPY . .
   CMD ["node", "server.js"]
   EXPOSE 3000
   -------------------------------------------------

4) Construye la imagen y ejecuta el contenedor:
   -------------------------------------------------
   docker build -t backend .
   docker run -d -p 3000:3000 backend
   -------------------------------------------------

5) Verifica que la API est√° funcionando accediendo a:
   http://<IP-BACKEND>:3000

----------------------------------------------------------------------
EJERCICIO 3: Configuraci√≥n de AWS RDS con PostgreSQL
----------------------------------------------------------------------
Teor√≠a:
AWS RDS nos permite ejecutar una base de datos administrada sin preocuparnos
por la infraestructura.

Pr√°ctica:
1) Crea una base de datos PostgreSQL en AWS RDS.

2) Configura las credenciales y anota la URL de conexi√≥n.

3) Modifica el backend para conectarse a RDS:
   -------------------------------------------------
   const { Pool } = require('pg');
   const pool = new Pool({
       user: 'admin',
       host: '<URL_RDS>',
       database: 'mi_base',
       password: 'contrase√±a',
       port: 5432
   });
   -------------------------------------------------

4) Verifica la conexi√≥n desde la API realizando una consulta de prueba.

----------------------------------------------------------------------
EJERCICIO 4: Implementaci√≥n del Frontend con Docker
----------------------------------------------------------------------
Teor√≠a:
El frontend es una aplicaci√≥n HTML, CSS y JavaScript servida con Nginx.

Pr√°ctica:
1) Con√©ctate a la instancia del frontend.

2) Clona el repositorio del frontend o crea un proyecto b√°sico.

3) Crea un Dockerfile:
   -------------------------------------------------
   FROM nginx
   COPY . /usr/share/nginx/html
   EXPOSE 80
   -------------------------------------------------

4) Construye y ejecuta el contenedor:
   -------------------------------------------------
   docker build -t frontend .
   docker run -d -p 80:80 frontend
   -------------------------------------------------

5) Verifica que el frontend funciona accediendo a:
   http://<IP-FRONTEND>

----------------------------------------------------------------------
EJERCICIO 5: Configuraci√≥n de un Application Load Balancer
----------------------------------------------------------------------
Teor√≠a:
El ALB distribuir√° el tr√°fico entre el frontend y las instancias backend.

Pr√°ctica:
1) Ve a AWS EC2 > Load Balancers y crea un Application Load Balancer.

2) Configura los Listeners:
   - HTTP (puerto 80) ‚Üí Target Group (Frontend)
   - HTTP (puerto 3000) ‚Üí Target Group (Backend)

3) Agrega las instancias EC2 al Target Group correspondiente.

4) Prueba el balanceo accediendo a la URL del ALB.

----------------------------------------------------------------------
EJERCICIO 6: Conectar el Frontend con el Backend
----------------------------------------------------------------------
Teor√≠a:
El frontend debe consumir datos del backend a trav√©s del ALB.

Pr√°ctica:
1) Modifica el c√≥digo JavaScript del frontend para llamar a la API:
   -------------------------------------------------
   fetch('http://<ALB-BACKEND-URL>:3000/api/datos')
   -------------------------------------------------

2) Verifica que el frontend puede acceder a los datos del backend.

----------------------------------------------------------------------
EJERCICIO 7: Configuraci√≥n de Seguridad en AWS
----------------------------------------------------------------------
Pr√°ctica:
1) Revisa los Security Groups:
   - Bloquea accesos innecesarios.
   - Permite solo tr√°fico entre instancias.

2) Configura reglas en RDS para permitir tr√°fico √∫nicamente desde
   la instancia del backend.

----------------------------------------------------------------------
EJERCICIO 8: Configurar Logs y Monitoreo
----------------------------------------------------------------------
Teor√≠a:
Es importante monitorear los logs de nuestros servicios.

Pr√°ctica:
1) Habilita CloudWatch Logs en AWS.

2) Configura los logs de Nginx y el backend para enviarlos a CloudWatch.

----------------------------------------------------------------------
EJERCICIO 9: Automatizaci√≥n con Docker Compose
----------------------------------------------------------------------
Pr√°ctica:
1) Crea un docker-compose.yml para gestionar tus servicios (frontend y backend).

2) Configura el backend y frontend para levantarlos con un solo comando:
   -------------------------------------------------
   docker-compose up -d
   -------------------------------------------------

----------------------------------------------------------------------
EJERCICIO 10: Pruebas Finales y Optimizaci√≥n
----------------------------------------------------------------------
Pr√°ctica:
1) Realiza pruebas de carga con herramientas como ab (Apache Benchmark).

2) Optimiza configuraciones de Nginx y PostgreSQL.

3) Documenta el flujo de despliegue y configuraci√≥n para tener una gu√≠a de
   referencia en futuras iteraciones.

----------------------------------------------------------------------
Con estos ejercicios, habr√°s aprendido a desplegar una aplicaci√≥n web escalable
en AWS con balanceo de carga y seguridad. ¬°Enhorabuena! üöÄ



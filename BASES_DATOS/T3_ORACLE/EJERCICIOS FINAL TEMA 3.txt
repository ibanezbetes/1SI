EJERCICIOS FINAL TEMA 3:


EJERCICIO 1:

SELECT EMPLE.APELLIDO,
       EMPLE.OFICIO,
       DEPART.LOC
FROM   EMPLE
       JOIN DEPART ON EMPLE.DEPT_NO = DEPART.DEPT_NO
WHERE  EMPLE.OFICIO = 'ANALISTA';



EJERCICIO 2:

SELECT *
FROM   EMPLE
WHERE  DIR = (
  SELECT EMPLE.EMP_NO
  FROM   EMPLE
  WHERE  EMPLE.APELLIDO = 'CEREZO'
);



EJERCICIO 3:

SELECT EMPLE.*
FROM   EMPLE
       JOIN DEPART ON EMPLE.DEPT_NO = DEPART.DEPT_NO
WHERE  DEPART.DNOMBRE = 'VENTAS';



EJERCICIO 4:

SELECT *
FROM   DEPART
WHERE  DEPART.DEPT_NO NOT IN (
    SELECT EMPLE.DEPT_NO
    FROM   EMPLE
);



EJERCICIO 5:

SELECT *
FROM   DEPART
WHERE  DEPART.DEPT_NO IN (
  SELECT EMPLE.DEPT_NO
  FROM   EMPLE
);



EJERCICIO 6:

SELECT EMPLE.APELLIDO,
       EMPLE.SALARIO
FROM   EMPLE
WHERE  EMPLE.SALARIO > ALL (
  SELECT EMPLE.SALARIO
  FROM   EMPLE
  WHERE  EMPLE.DEPT_NO = 20
);



EJERCICIO 7:

SELECT LIBRERIA.TEMA,
       LIBRERIA.ESTANTE,
       LIBRERIA.EJEMPLARES
FROM   LIBRERIA
WHERE  LIBRERIA.EJEMPLARES BETWEEN 8 AND 15;



EJERCICIO 8:

SELECT LIBRERIA.TEMA,
       LIBRERIA.ESTANTE,
       LIBRERIA.EJEMPLARES
FROM   LIBRERIA
WHERE  LIBRERIA.ESTANTE < 'B'
   OR  LIBRERIA.ESTANTE > 'D';



EJERCICIO 9:

SELECT LIBRERIA.TEMA
FROM   LIBRERIA
WHERE  LIBRERIA.EJEMPLARES < (
  SELECT LIBRERIA_SUB.EJEMPLARES
  FROM   LIBRERIA LIBRERIA_SUB
  WHERE  LIBRERIA_SUB.TEMA = 'MEDICINA'
);



EJERCICIO 10:

SELECT LIBRERIA.TEMA
FROM   LIBRERIA
WHERE  LIBRERIA.EJEMPLARES NOT BETWEEN 15 AND 20;



EJERCICIO 11:

SELECT ASIGNATURAS.NOMBRE
FROM   ASIGNATURAS
WHERE  ASIGNATURAS.NOMBRE LIKE '%o%o%o%'
  AND  ASIGNATURAS.COD IN (
       SELECT NOTAS.COD
       FROM   NOTAS
              JOIN ALUMNOS ON NOTAS.DNI = ALUMNOS.DNI
       WHERE  ALUMNOS.POBLA = 'Madrid'
);



EJERCICIO 12:

SELECT DISTINCT ALUMNOS.APENOM
FROM   ALUMNOS
       JOIN NOTAS ON ALUMNOS.DNI = NOTAS.DNI
WHERE  ALUMNOS.POBLA = 'Madrid'
  AND  NOTAS.NOTA < 5;



EJERCICIO 13:

SELECT DISTINCT ALUMNOS.APENOM
FROM   ALUMNOS
       JOIN NOTAS ON ALUMNOS.DNI = NOTAS.DNI
WHERE  NOTAS.NOTA = (
  SELECT NOTAS_MARIA.NOTA
  FROM   NOTAS NOTAS_MARIA
         JOIN ALUMNOS ALUMNOS_MARIA ON NOTAS_MARIA.DNI = ALUMNOS_MARIA.DNI
  WHERE  ALUMNOS_MARIA.APENOM = 'Díaz Fernández, María'
    AND  NOTAS_MARIA.COD = 4  
);



EJERCICIO 14:

SELECT *
FROM   ASIGNATURAS
WHERE  ASIGNATURAS.COD NOT IN (
  SELECT NOTAS.COD
  FROM   NOTAS
);



EJERCICIO 15:

SELECT ALUMNOS.APENOM
FROM   ALUMNOS
       JOIN NOTAS ON ALUMNOS.DNI = NOTAS.DNI
WHERE  NOTAS.COD = 1;



EJERCICIO 16:

SELECT ALUMNOS.APENOM
FROM   ALUMNOS
WHERE  ALUMNOS.DNI NOT IN (
  SELECT NOTAS.DNI
  FROM   NOTAS
  WHERE  NOTAS.COD = 1
);